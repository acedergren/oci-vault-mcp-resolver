# Template for Custom MCP Server Configuration
# Copy this file and customize for your service
#
# Usage:
#   1. Copy: cp template.yaml myservice.yaml
#   2. Replace placeholders: {SERVICE}, {TYPE}, command, args
#   3. Create vault secrets with pattern: mcp-{service}-{type}
#   4. Test: node ../wrapper.js --config myservice.yaml

# ============================================================================
# COMMAND CONFIGURATION
# ============================================================================
# The command to execute your MCP server
# Examples:
#   - npx -y @modelcontextprotocol/server-name
#   - node /path/to/your/server.js
#   - python3 /path/to/your/server.py
#   - docker run --rm your-mcp-server
command: REPLACE_WITH_COMMAND

# Arguments to pass to the command
args:
  - "REPLACE_WITH_ARG1"
  - "REPLACE_WITH_ARG2"
  # Add more args as needed

# ============================================================================
# ENVIRONMENT VARIABLES
# ============================================================================
# Environment variables with secret resolution patterns:
#
# Pattern                   | Example                          | Description
# --------------------------|----------------------------------|---------------------------
# vault://secret-name       | vault://mcp-service-api-key      | Fetch from OCI Vault
# ${ENV_VAR}                | ${API_KEY}                       | Fallback to local env var
# ${ENV_VAR:-default}       | ${PORT:-3000}                    | With default value
# literal-value             | production                       | Static value
# prefix-${VAR}-suffix      | https://${HOST}/api              | String interpolation
#
env:
  # Example: API Key from vault
  SERVICE_API_KEY: "vault://mcp-SERVICENAME-api-key"

  # Example: Connection URL from vault
  SERVICE_URL: "vault://mcp-SERVICENAME-url"

  # Example: Static configuration
  SERVICE_ENVIRONMENT: "production"

  # Example: Environment variable fallback
  SERVICE_TIMEOUT: "${SERVICE_TIMEOUT:-30000}"

  # Example: Password with fallback
  SERVICE_PASSWORD: "vault://mcp-SERVICENAME-password"

  # Example: Optional config
  # SERVICE_OPTIONAL: "${SERVICE_OPTIONAL}"

# ============================================================================
# OCI VAULT CONFIGURATION (OPTIONAL)
# ============================================================================
# Uncomment and customize if you need non-default vault settings
# Otherwise, wrapper uses defaults from environment or instance

# vault:
#   # Vault OCID (required if not in env)
#   vaultId: "ocid1.vault.oc1.region.xxxxx"
#
#   # Compartment OCID (required if not in env)
#   compartmentId: "ocid1.compartment.oc1..xxxxx"
#
#   # Region (required if not in env)
#   region: "us-ashburn-1"
#
#   # Authentication method (choose one):
#   # Option 1: Instance Principal (for OCI Compute)
#   useInstancePrincipal: true
#
#   # Option 2: Config file (for local development)
#   # configFile: "~/.oci/config"
#   # profile: "DEFAULT"

# ============================================================================
# VAULT SECRET NAMING CONVENTION
# ============================================================================
# Follow the pattern: mcp-{service}-{type}
#
# Examples:
#   mcp-myservice-api-key       - API authentication key
#   mcp-myservice-secret        - Generic secret/token
#   mcp-myservice-url           - Connection URL
#   mcp-myservice-password      - Database/service password
#   mcp-myservice-client-id     - OAuth client ID
#   mcp-myservice-client-secret - OAuth client secret
#   mcp-myservice-webhook-url   - Webhook endpoint
#   mcp-myservice-encryption-key - Encryption key
#
# Create secrets in OCI Vault:
#   oci vault secret create-base64 \
#     --compartment-id "ocid1.compartment.oc1..xxxxx" \
#     --vault-id "ocid1.vault.oc1.region.xxxxx" \
#     --secret-name "mcp-myservice-api-key" \
#     --key-id "ocid1.key.oc1.region.xxxxx" \
#     --secret-content-content "$(echo -n 'your-secret-value' | base64)"

# ============================================================================
# DOCKER MCP GATEWAY INTEGRATION
# ============================================================================
# To use with Docker MCP Gateway, add to claude_desktop_config.json:
#
# {
#   "mcpServers": {
#     "myservice": {
#       "command": "docker",
#       "args": [
#         "exec",
#         "mcp-gateway",
#         "node",
#         "/app/wrappers/wrapper.js",
#         "--config",
#         "/app/config/myservice.yaml"
#       ]
#     }
#   }
# }
#
# And mount in docker-compose.yml:
#
# services:
#   mcp-gateway:
#     volumes:
#       - ./config:/app/config
#       - ./oci-vault-mcp-resolver/wrappers:/app/wrappers
#       - ./oci-vault-mcp-resolver/dist:/app/dist
#       - ~/.oci:/root/.oci:ro

# ============================================================================
# TESTING
# ============================================================================
# Test your configuration:
#
# 1. Set up vault secrets (see commands above)
#
# 2. Test wrapper execution:
#    node ../wrapper.js --config myservice.yaml
#
# 3. Test with debug logging:
#    DEBUG=oci-vault-mcp-wrapper node ../wrapper.js --config myservice.yaml
#
# 4. Test manual command (to isolate issues):
#    export SERVICE_API_KEY="test-value"
#    REPLACE_WITH_COMMAND REPLACE_WITH_ARG1 REPLACE_WITH_ARG2
#
# 5. Verify vault access:
#    oci vault secret list \
#      --compartment-id "ocid1.compartment.oc1..xxxxx" \
#      --vault-id "ocid1.vault.oc1.region.xxxxx" \
#      --query 'data[?starts_with("secret-name", `mcp-myservice-`)]'
